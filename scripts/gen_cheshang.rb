# -*- coding: UTF-8 -*-

require 'rubygems'
require 'mysql2'
require 'pp'



@adapter= "mysql2"
@host= "ip"
@database= "db"
@username= "user"
@password= "pwd"

city=%w(
七台河
万宁
三亚
三明
三沙
三门峡
上海
上虞
上饶
东方
东莞
东营
东阳
个旧
中卫
中山
临夏
临夏回族
临夏州
临安
临汾
临沂
临沧
临海
临猗
临高
丹东
丹江口
丹阳
丽水
丽江
义乌
乌兰察布
乌兰察布盟
乌海
乌鲁木齐
乐东
乐山
乐清
九江
云浮
五家渠
五指山
亳州
介休
仙桃
仪征
任丘
伊宁
伊春
伊犁
伊犁哈萨克
余姚
余杭
佛山
佳木斯
侯马
保亭
保定
保山
信阳
儋州
克孜勒苏
克孜勒苏柯尔克孜
克拉玛依
六安
六盘水
兰州
兴义
兴安
兴安盟
其他
内江
凉山
凯里
利川
包头
北京
北宁
北安
北海
十堰
南京
南充
南宁
南安
南平
南昌
南通
南阳
博尔塔拉
厦门
双鸭山
台山
台州
台湾
合肥
吉安
吉林
吉林市
吉首
吐鲁番
吕梁
吴忠
吴江
周口
呼伦贝尔
呼伦贝尔盟
呼和浩特
和县
和田
咸宁
咸阳
哈密
哈尔滨
唐山
商丘
商洛
喀什
嘉兴
嘉峪关
四平
固原
图木舒克
垦利
塔城
大丰
大兴安岭
大厂
大同
大庆
大理
大理州
大石桥
大连
天台
天水
天津
天门
太仓
太原
奎屯
威海
娄底
嫩江
孝义
孝感
宁德
宁波
安吉
安庆
安康
安阳
安顺
定安
定州
定西
宜兴
宜宾
宜州
宜昌
宜春
宝鸡
宣城
宿州
宿迁
富阳
寿光
尚志
屯昌
山南
岳阳
崇左
嵊州
巢湖
巴中
巴州库尔勒
巴彦淖尔
巴彦淖尔盟
巴音郭勒
巴音郭楞
常州
常德
常熟
平凉
平度
平阳
平顶山
广元
广安
广州
庄河
庆阳
库尔勒
廊坊
延吉
延安
延边
建德
建瓯
开封
开平
张北
张家口
张家港
张家界
张掖
徐州
德宏
德州
德清
德阳
忻州
怀化
怒江
恩平
恩施
恩施州
惠州
慈溪
成都
扬州
承德
抚州
抚顺
拉萨
招远
揭阳
攀枝花
文山
文昌
新乡
新余
新疆克州
新疆直辖
新郑
新馀
无锡
日喀则
日照
昆山
昆明
昌吉
昌吉州
昌江
昌都
明港
昭通
晋中
晋城
晋江
普宁
普洱
景德镇
曲靖
朔州
朝阳
本溪
来宾
杭州
松原
林州
林芝
果洛
枣庄
株洲
桂林
桐城
桐庐
梅州
梅河口
梧州
楚雄
楚雄州
榆林
榆次
正定
武夷山
武威
武汉
毕节
永嘉
永安
永州
永康
永新
汉中
汕头
汕尾
江宁
江都
江门
江阴
池州
沈阳
沧州
沭阳
河南直辖
河池
河津
河源
泉州
泰兴
泰安
泰州
泸州
洛阳
济南
济宁
济源
济源市
浏阳
海东
海北
海南
海南直辖
海口
海城
海安
海拉尔
海西
涿州
淄博
淮北
淮南
淮安
淮阴
深圳
清徐
清远
温岭
温州
渭南
湖北直辖
湖州
湘潭
湘西
湛江
滁州
滕州
滨州
漯河
漳州
潍坊
潜江
潮州
澄海
澄迈
澳门
濮阳
烟台
焦作
牡丹江
玉林
玉树
玉溪
珠海
琼中
琼海
瑞安
瓦房店
甘南
甘南藏族
甘孜
白城
白山
白沙
白银
百色
益阳
盐城
盘锦
眉山
石嘴山
石家庄
石河子
神农架
福州
禹州
离石
秦皇岛
章丘
米泉
红河
绍兴
绥化
绥芬河
绵阳
聊城
肇庆
胶南
自贡
舟山
芜湖
苍南
苏州
茂名
荆州
荆门
莆田
莱芜
莱西
莱阳
菏泽
萍乡
营口
萧山
葫芦岛
蚌埠
衡水
衡阳
衢州
襄樊
襄阳
西双版纳
西宁
西安
西昌
许昌
诸城
贵港
贵阳
贺州
资阳
赣州
赤峰
赵县
辛集
辽源
辽阳
达川
达州
迁安
运城
连云港
迪庆
通化
通辽
遂宁
遵义
邢台
那曲
邯郸
邵东
邵武
邵阳
郑州
郴州
都匀
鄂尔多斯
鄂州
鄢陵
酒泉
重庆
金华
金昌
钦州
铁岭
铜仁
铜川
铜陵
银川
锡林郭勒
锡林郭勒盟
锦州
镇江
长兴
长春
长沙
长治
长葛
阜新
阜阳
防城港
阳春
阳江
阳泉
阿克苏
阿勒泰
阿坝
阿拉善
阿拉善盟
阿拉尔
阿里
陇南
陵水
随州
雅安
集宁
霍邱
青岛
青州
靖江
鞍山
韶关
顺德
馆陶
香港
马鞍山
驻马店
高密
高要
鸡西
鹤壁
鹤岗
鹰潭
黄冈
黄南
黄山
黄岩
黄石
黑河
黔东南
黔南
黔西南
齐齐哈尔
龙口
龙岩
)

def mstr(c)
	"select  c.id, c.city, l.type, m.site, '' , m.merchant_name,m.merchant_address, m.merchant_tel1,m.merchant_mobile1,m.merchant_url,
l.linkman,l.linkman_tel1,l.linkman_tel2,l.linkman_tel3,l.linkman_mobile1,l.linkman_mobile2,l.linkman_mobile3
 from
car_info_t as c force index (index_input_date)
        left join lv2_merchant_info as m on m.id = c.mid 
        left join linkman_info_t as l on l.id = c.lid
where 1 = 1 
-- and c.site in (1,2,3)
and c.input_date between '2014-08-01 00:00:00' and '2014-09-01 00:00:00'
and c.mid <> 0
and l.type in (3)
and c.id is not null
and c.city = \'#{c}\'
GROUP BY mid,lid
 INTO OUTFILE \'/data/report/city/cheshang_all_#{c}.txt\' FIELDS TERMINATED BY '\t' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\n' 
"

end

client = Mysql2::Client.new(:host => @host, :username => @username,:password=>@password,:database=>@database,:port => 3307)

i = 0
city.each do |c|
	#puts mstr(c)
	#client.query(mstr(c))
        puts "ruby city.rb #{c} && ruby name.rb #{c} > #{c}_name.txt &"
	puts "sleep 1000" if i % 20 == 0
	i += 1
end

	



